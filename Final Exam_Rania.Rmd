---
title: "Final Exam_Rania"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Load libraries

```{r load libraries, message=FALSE}
library(tidyverse)
library(tidycensus)
library(readxl)
library(knitr)
library(tigris)
library(sf)
library(gridExtra)
library(interactions)
```

## Load Data
```{r, message=FALSE}
Main_st_data <- read_csv("finalexam_sampledata.csv")
```

# Question 1

What is the average change in sales for Main street businesses? 
Did sales increase of decrease on average? 
How confident are you about that?

```{r}
t.test(Main_st_data$pct_sales_chng)
```

Mean of x
On average, Main street businesses saw a (2.7%) (increase) in sales. 

95 percent confidence interval:
The 95-percent confidence interval for the (increase) is (2.4 to 3.1) percent. 

p-value
Since the p-value for this estimate is less than (0.001), we can be more than (99.9-percent) confident that sales increased.


## Question 2 

Did the cost of parking change more for some types of businesses than for others?
How confident are you about those differences?

To interpret the regression in a meaningful way, I will first find the most common store type so I can compare other types to it.
```{r}
Main_st_data %>%
  group_by(type) %>%
  summarise(number = n()) %>%
  mutate(percent = round(100*number / sum(number))) %>%
  arrange(desc(number))
```

(Clothing) stores are the most common so I will compare everything back to clothing and relevel the regression back to it

```{r}
Main_st_data <- Main_st_data %>%
  mutate(type = as.factor(type)) %>%
  mutate(type = relevel(type, "Clothing"))
```

I will now do the bivariate regression to see which store types have changes in parking costs comparing to the changes in clothing stores.

```{r}
parking_cost_by_type <- lm(parking_cost_by_type ~ type, data= Main_st_data)
summary(parking_cost_by_type)
```


